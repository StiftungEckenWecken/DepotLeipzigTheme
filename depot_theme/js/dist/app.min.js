<<<<<<< HEAD
!function n(r,s,l){function c(t,e){if(!s[t]){if(!r[t]){var a="function"==typeof require&&require;if(!e&&a)return a(t,!0);if(d)return d(t,!0);var o=new Error("Cannot find module '"+t+"'");throw o.code="MODULE_NOT_FOUND",o}var i=s[t]={exports:{}};r[t][0].call(i.exports,function(e){return c(r[t][1][e]||e)},i,i.exports,n,r,s,l)}return s[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.getDistancesForActivePage=function(e,t){var a=[];jQuery(".view-resources-list .resource-wrapper").each(function(){a.push(jQuery(this).attr("data-resource-id"))}),jQuery.ajax({url:Drupal.settings.basePath+"depot/ajax/getDistanceFromLocations?lng="+t+"&lat="+e+"&ids="+a.join(","),type:"GET",contentType:"application/json",error:function(){console.log("getDistanceFromLocations: request failed.")},success:function(o){void 0!==o.status&&"success"===o.status&&Object.keys(o.data).forEach(function(e){var t=(Number(o.data[e])/1e3).toString().replace(".",",").substr(0,3)+"0",a=jQuery('.view-resources-list .resource-wrapper[data-resource-id="'+e+'"]');a&&a.find(".resource-link").append('\n                                    <div class="user-badge price-badge resource-distance-badge medium-1 column" style="display:none;">\n                                        '+t+"<br /> km\n                                    </div>").find(".resource-distance-badge").fadeIn("slow")})}})}},{}],2:[function(e,t,a){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var o=function(){function o(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,a){return t&&o(e.prototype,t),a&&o(e,a),e}}();var i=function(){function p(e,i){var t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,n=this,r=3<arguments.length&&void 0!==arguments[3]&&arguments[3],a=4<arguments.length&&void 0!==arguments[4]?arguments[4]:12;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),"NaN"!==parseFloat(i.maps_default_lat)&&"NaN"!==parseFloat(i.maps_default_lng))if(void 0!==i.maps_app_id&&void 0!==i.maps_app_code)if("undefined"!=typeof H){var o=new H.service.Platform({app_id:i.maps_app_id,app_code:i.maps_app_code,useHTTPS:!0}).createDefaultLayers();this.map=new H.Map(e,r?o.terrain.map:o.normal.map,{zoom:a,center:{lat:parseFloat(i.maps_default_lat),lng:parseFloat(i.maps_default_lng)}});var s=-1;this.map.addEventListener("mapviewchangeend",function(e){s++});new H.mapevents.Behavior(new H.mapevents.MapEvents(this.map));var l=H.ui.UI.createDefault(this.map,o,"de-DE");this.markerGroup=new H.map.Group,this.map.addObject(this.markerGroup);var c=this,d=void 0;if(this.markerGroup.addEventListener("tap",function(e){var t=new H.ui.InfoBubble(e.target.getPosition(),{content:e.target.getData()});d&&l.removeBubble(d),d=t,l.addBubble(t),c.map.setCenter(e.target.getPosition()),0===s&&c.map.zoomAt(14)},!1),t){var u={};t.forEach(function(e){var t=0,a=e.lat.toString()+e.lng.toString();void 0!==u[a]?(t=u[a],e.lng=e.lng+1.0001*t/3e3,u[a]++):u[a]=1;var o=new H.map.DomMarker({lat:e.lat,lng:e.lng},{icon:n._generateDomMarker()});r?o.setData('<p>\n                                        <a \n                                        href="'+e.link+'"\n                                        title="'+i.t_map_open_resource+'"\n                                        target="_blank">\n                                            '+e.title+"\n                                        </a>\n                                    </p>"):o.setData('<p>\n                                        <a\n                                        href="/ressourcen/'+e.slug+'"\n                                        title="'+i.t_map_open_resource+'"\n                                        target="_blank">\n                                            '+e.title+"\n                                        </a> - "+e.adress+"\n                                    </p>"),c.markerGroup.addObject(o)})}}else console.log("depot-maps.js - WARNING: No maps assets loaded. Will abort");else console.log("depot-maps.js - WARNING: Missing API credentials");else console.log("depot-maps.js - WARNING: Got none or invalid HERE maps credentials")}return o(p,[{key:"addMarker",value:function(e){var t=new H.map.DomMarker({lat:e.lat,lng:e.lng},{icon:this._generateDomMarker(void 0!==e.icon?e.icon:"marker.png",1)});return void 0!==e.htmlData&&t.setData(e.htmlData),this.markerGroup.addObject(t,1),this}}]),o(p,[{key:"_generateDomMarker",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"marker.png",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:.75,a=document.createElement("div"),o=document.createElement("div");a.style.userSelect="none",a.style.webkitUserSelect="none",a.style.msUserSelect="none",a.style.mozUserSelect="none",a.style.cursor="pointer",a.style.opacity=t,o.style.width="30px",o.style.height="32px",o.style.marginTop="-16px",o.style.marginLeft="-15px",a.appendChild(o),o.innerHTML='<img src="/sites/all/themes/depot_theme/images/'+e+'" />';var i=function(e){e.target.style.opacity=t},n=function(e){e.target.style.opacity=1};return new H.map.DomIcon(a,{onAttach:function(e,t,a){e.addEventListener("mouseover",n),e.addEventListener("mouseout",i)},onDetach:function(e,t,a){e.removeEventListener("mouseover",n),e.removeEventListener("mouseout",i)}})}}]),p}();a.default=i},{}],3:[function(e,t,a){"use strict";var o,u,p,g,f,m,i=e("./depot-maps"),v=(o=i)&&o.__esModule?o:{default:o},h=e("./depot-api");u=jQuery,p=window,g=window.document,f={},m=void 0,Drupal.behaviors.depot={attach:function(e,n){function i(e){return e.replace(/^\//,"").replace(/(index|default).[a-zA-Z]{3,4}$/,"").replace(/\/$/,"")}var r=i(location.pathname);if(u('a[href*="#"]').each(function(){var e=i(this.pathname)||r,t=this.hash.replace("#%22","");if(u("#"+t.replace(/#/,"")).length&&r===e&&(location.hostname===this.hostname||!this.hostname)&&this.hash.replace(/#/,"")){var a=u(t),o=this.hash;o&&u(this).click(function(e){e.preventDefault(),u("html, body").animate({scrollTop:a.offset().top},1e3,function(){if(location.hash=o,a.focus(),a.is(":focus"))return!1;a.attr("tabindex","-1"),a.focus()})})}}),u("#main-menu",e).once("toggle_region_select",function(){u("#main-menu__region-selected").click(function(){var e=u(this);e.addClass("active-trail"),u("#depot-region-select").css({left:e.offset().left,top:e.height()}).show(),n.depot.maps_default_lat=51.165,n.depot.maps_default_lng=10.455278,new v.default(g.getElementById("depot-regions-map"),n.depot,depotRegionMarkers,!0,5),u("#depot-region-select .close-popup").click(function(){u("#depot-region-select").hide(),e.removeClass("active-trail")})})}),1<=u(".form-item-field-fake-kategorie").length){var o=u("#edit-field-fake-kategorie");o.select2({placeholder:n.depot.t_addKategorienPlaceholder,maximumSelectionLength:3});var t=function(){for(var e=o.select2("data"),t=0;3!==t;t++){var a=void 0!==e[t]?e[t].id:"";u("#edit-field-kategorie-und-"+t+"-state-id").val(a)}};o.on("select2:select",t).on("select2:unselect",t)}if(1===u("#depot-resources-map").length&&u("#depot-resources-map",e).once("add-map",function(){f.resourcesMap=new v.default(g.getElementById("depot-resources-map"),n.depot,depotResourceMarkers)}),u("body").hasClass("page-ressourcen")&&u("#edit-field-kosten-2-und-0-value").length&&(u("#edit-field-kosten-2-und-0-value, #edit-field-kosten-und-0-value").on("keyup",function(e){var t=u(this).val();isNaN(t)&&-1===t.indexOf("€")&&2<(t=t.replace(/[^0-9\,]/g,"")).split(",").length&&(t=t.replace(/\,+$/,"")),t=t.replace(".",","),u(this).val(t)}),u("#edit-field-kosten-2-und-0-value, #edit-field-kosten-und-0-value").on("focusout",function(e){e.preventDefault();var t=u(this).val();String(t).indexOf(",")<0&&(t+=",00€",u(this).val(t)),String(t).indexOf("€")<0&&(t+="€",u(this).val(t))})),!u("body").hasClass("section-ressourcen")||u("body").hasClass("page-ressourcen-edit")||u("#resources-list-selectize").length||(0<=location.hash.indexOf("#sperrzeiten")&&u("#openVerfuegbarkeitenModal").click(),u("#availability_calendar_btn").click(function(){if("undefined"!=typeof cal&&"function"==typeof cal.show)return cal.show(),!1;console.log("depot.js - ATTENTION: Missing or corrupt resourceCal settings")}),"undefined"!=typeof depotResourceMarker?u("#open-resource-map").click(function(){u(g).scrollTop(0),""===u("#depot-resource-map").html()&&p.setTimeout(function(){n.depot.maps_default_lat=depotResourceMarker[0].lat,n.depot.maps_default_lng=depotResourceMarker[0].lng,new v.default(g.getElementById("depot-resource-map"),n.depot,depotResourceMarker)},1e3)}):console.log("depot.js - ATTENTION: No map rendered as geodata is missing")),1<=u(".view-resources-list").length){if("geolocation"in navigator){var s=localStorage;null!==s.getItem("lat")&&null!==s.getItem("lng")&&(f._geolocation={lat:s.getItem("lat"),lng:s.getItem("lng")}),void 0!==f._geolocation?(0,h.getDistancesForActivePage)(f._geolocation.lat,f._geolocation.lng):navigator.geolocation.getCurrentPosition(function(e){var t=e.coords.latitude,a=e.coords.longitude;f._geolocation={lat:t,lng:a},(0,h.getDistancesForActivePage)(t,a),void 0!==f.resourcesMap&&f.resourcesMap.addMarker({lat:t,lng:a,icon:"marker_myself.png",htmlData:"<p>\n                                             <strong>Dein Standort (geschätzt)</strong>\n                                           </p>"}),s.setItem("lat",t.toString()),s.setItem("lng",a.toString()),s.setItem("timestamp",Date.now().toString())})}if(u("body",e).once("resources-list-selectize",function(){u("body").hasClass("section-ressourcen")&&u("#main-content").prepend(u("#resources-list-selectize"));var e=[];u("#edit-kategorie-id option").each(function(){e.push({value:u(this).val(),text:u(this).html().replace(/&amp;/,"&")})});var t=u("#resources-list-selectize select").selectize({delimiter:",",persist:!1,maxItems:2,options:e,placeholder:n.depot.t_filterKategorienPlaceholder,closeAfterSelect:!0,selectOnTab:!0,create:function(e){return{value:e,text:e}},render:{option_create:function(e,t){if(3<=t(e.input).toString().length)return'<div class="create">Nach Schlagwort "<strong>'+t(e.input)+'</strong>" suchen&hellip;</div>'}}});(m=t[0].selectize).on("option_add",function(e,t){u("#resources-list-selectize__clear").removeClass("hide"),u("#edit-kategorie-id").val([]),u('input[name="query"]').val(e).trigger("change")}),m.on("clear",function(){u("#resources-list-selectize__clear").addClass("hide"),u('input[name="query"]').val(""),u("#edit-kategorie-id").val([]).trigger("change")}),m.on("item_remove",function(e){m.trigger("option_remove",e)}),m.on("option_remove",function(e){isNaN(e)?u('input[name="query"]').val("").trigger("change"):u("#edit-kategorie-id").val([]).trigger("change")}),m.on("item_add",function(e,t){u("#resources-list-selectize__clear").removeClass("hide");var a="category";if(isNaN(e)){if(a="query",t.addClass("is-tag-item"),1<u(".selectize-input .item.is-tag-item").length){var o=u(".selectize-input .item.is-tag-item").first().attr("data-value");m.removeOption(o)}}else{if(1<u(".selectize-input .item").not(".is-tag-item").length){var i=u(".selectize-input .item").not(".is-tag-item").first().attr("data-value");m.removeOption(i)}u("#edit-name").val(""),u("#edit-kategorie-id").val(e).trigger("change")}t.html().toString().indexOf("item-type")<0&&t.html(t.html()+' <span class="item-type">'+n.depot["t_search_type_"+a]+"</span>")}),u("#resources-list-selectize__clear").click(function(){m.clear()})}),void 0!==Drupal.settings.views&&void 0!==Drupal.settings.views.ajaxViews.views_dom_id_startpage&&void 0!==Drupal.settings.views.ajaxViews.views_dom_id_startpage.view_display_id&&(Drupal.settings.views.ajaxViews.views_dom_id_startpage.view_display_id="page"),u(".depot-resources-list__no-results-reset-filter").click(function(){m.clear()}),!u("body").hasClass("section-ressourcen")){var a=0;u(".view-resources-list .resource-wrapper").each(function(e,t){9<=e&&u(t).addClass("hide"),a=e}),u("#depot-resources-list__btn-expand").click(function(){return u(this).addClass("hide"),u(".view-resources-list .resource-wrapper.hide, #depot-resources-list__btn-show-more").removeClass("hide"),!1}),a<=9&&u("#depot-resources-list__btn-expand").trigger("click")}}u('#edit-field-links-i input[type="text"]').keyup(function(){1<=u(this).val().length&&u("#edit-field-links-ii").removeClass("hide")}),u('#edit-field-links-ii input[type="text"]').keyup(function(){1<=u(this).val().length&&u("#edit-field-links-iii").removeClass("hide")}),u(".fieldset-toggle legend").click(function(){u(this).closest(".fieldset-toggle").toggleClass("toggled")}),u("body").hasClass("section-ressourcen")&&1<p.location.pathname.search("av")&&u("#verfuegbarkeitenModal").trigger("click");var l=u(".follow-box");if(0<l.length&&641<u(p).width()){for(var c=[],d=0;d<l.length;d++)c.push({element:l[d],offset:u(l[d]).offset()});u(p).scroll(function(e){for(var t=u(e.currentTarget).scrollTop(),a=0;a<c.length;a++){var o=l.height()+30;t>c[a].offset.top?(u(c[a].element).addClass("follow"),o<t?u(c[a].element).addClass("fade-out"):u(c[a].element).removeClass("fade-out")):u(c[a].element).removeClass("follow").removeClass("fade-out")}})}}}},{"./depot-api":1,"./depot-maps":2}]},{},[1,2,3]);
=======
!function r(s,i,l){function c(t,e){if(!i[t]){if(!s[t]){var o="function"==typeof require&&require;if(!e&&o)return o(t,!0);if(d)return d(t,!0);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}var n=i[t]={exports:{}};s[t][0].call(n.exports,function(e){return c(s[t][1][e]||e)},n,n.exports,r,s,i,l)}return i[t].exports}for(var d="function"==typeof require&&require,e=0;e<l.length;e++)c(l[e]);return c}({1:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var a=function(){function a(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,o){return t&&a(e.prototype,t),o&&a(e,o),e}}();var n=function(){function d(e,a){var n=this,t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,d),"NaN"!==parseFloat(a.maps_default_lat)&&"NaN"!==parseFloat(a.maps_default_lng))if(void 0!==a.maps_app_id&&void 0!==a.maps_app_code)if("undefined"!=typeof H){var o=new H.service.Platform({app_id:a.maps_app_id,app_code:a.maps_app_code,useHTTPS:!0}).createDefaultLayers(),r=new H.Map(e,o.normal.map,{zoom:12,center:{lat:parseFloat(a.maps_default_lat),lng:parseFloat(a.maps_default_lng)}}),s=(new H.mapevents.Behavior(new H.mapevents.MapEvents(r)),H.ui.UI.createDefault(r,o,"de-DE")),i=new H.map.Group;r.addObject(i);var l=void 0;if(i.addEventListener("tap",function(e){var t=new H.ui.InfoBubble(e.target.getPosition(),{content:e.target.getData()});l&&s.removeBubble(l),l=t,s.addBubble(t),r.setCenter(e.target.getPosition()),r.zoomAt(14)},!1),t){var c={};t.forEach(function(e){var t=e.lat.toString()+e.lng.toString();void 0!==c[t]?(c[t],c[t]++):c[t]=1,console.log(c[t]);var o=new H.map.DomMarker({lat:e.lat,lng:e.lng},{icon:n._generateDomMarker()});o.setData('<p>\n                                <a href="/ressourcen/'+e.slug+'"\n                                 title="'+a.t_map_open_resource+'"\n                                 target="_blank">\n                                    '+e.title+"\n                                </a> - "+e.adress+"\n                                </p>"),i.addObject(o)})}}else console.log("depot-maps.js - WARNING: No maps assets loaded. Will abort");else console.log("depot-maps.js - WARNING: Missing API credentials");else console.log("depot-maps.js - WARNING: Got none or invalid HERE maps credentials")}return a(d,[{key:"_generateDomMarker",value:function(){var e=document.createElement("div"),t=document.createElement("div");e.style.userSelect="none",e.style.webkitUserSelect="none",e.style.msUserSelect="none",e.style.mozUserSelect="none",e.style.cursor="pointer",e.style.opacity=.75,t.style.width="30px",t.style.height="32px",t.style.marginTop="-16px",t.style.marginLeft="-15px",e.appendChild(t),t.innerHTML='<img src="/sites/all/themes/depot_theme/images/marker.png" />';var a=function(e){e.target.style.opacity=.75},n=function(e){e.target.style.opacity=1};return new H.map.DomIcon(e,{onAttach:function(e,t,o){e.addEventListener("mouseover",n),e.addEventListener("mouseout",a)},onDetach:function(e,t,o){e.removeEventListener("mouseover",n),e.removeEventListener("mouseout",a)}})}}]),d}();o.default=n},{}],2:[function(e,t,o){"use strict";var a,d,u,p,n=e("./depot-maps"),f=(a=n)&&a.__esModule?a:{default:a};d=jQuery,u=window,p=window.document,Drupal.behaviors.depot={attach:function(e,t){function n(e){return e.replace(/^\//,"").replace(/(index|default).[a-zA-Z]{3,4}$/,"").replace(/\/$/,"")}var r=n(location.pathname);if(d('a[href*="#"]').each(function(){var e=n(this.pathname)||r,t=this.hash;if(d("#"+t.replace(/#/,"")).length&&r===e&&(location.hostname===this.hostname||!this.hostname)&&this.hash.replace(/#/,"")){var o=d(t),a=this.hash;a&&d(this).click(function(e){e.preventDefault(),d("html, body").animate({scrollTop:o.offset().top},1e3,function(){if(location.hash=a,o.focus(),o.is(":focus"))return!1;o.attr("tabindex","-1"),o.focus()})})}}),d("#main-menu",e).once("toggle_region_select",function(){d("#main-menu__region-selected").click(function(){var e=d(this);e.addClass("active-trail"),d("#depot-region-select").css({left:e.offset().left,top:e.height()}).show(),d("#depot-region-select .close-popup").click(function(){d("#depot-region-select").hide(),e.removeClass("active-trail")})})}),1<=d(".form-item-field-fake-kategorie").length){var a=d("#edit-field-fake-kategorie");a.select2({placeholder:t.depot.t_addKategorienPlaceholder,maximumSelectionLength:3});var o=function(){for(var e=a.select2("data"),t=0;3!==t;t++){var o=void 0!==e[t]?e[t].id:"";d("#edit-field-kategorie-und-"+t+"-state-id").val(o)}};a.on("select2:select",o).on("select2:unselect",o)}if(1===d("#depot-resources-map").length&&d("#depot-resources-map",e).once("add-map",function(){new f.default(p.getElementById("depot-resources-map"),t.depot,depotResourceMarkers)}),d("body").hasClass("section-ressourcen")&&!d("body").hasClass("page-ressourcen-edit")&&(d("#availability_calendar_btn").click(function(){return"undefined"!=typeof cal&&"function"==typeof cal.show?cal.show():console.log("depot.js - ATTENTION: Missing or corrupt resourceCal settings"),!1}),"undefined"!=typeof depotResourceMarker?d("#open-resource-map").click(function(){d(p).scrollTop(0),""===d("#depot-resource-map").html()&&u.setTimeout(function(){t.depot.maps_default_lat=depotResourceMarker[0].lat,t.depot.maps_default_lng=depotResourceMarker[0].lng,new f.default(p.getElementById("depot-resource-map"),t.depot,depotResourceMarker)},1e3)}):console.log("depot.js - ATTENTION: No map rendered as geodata is missing")),1<=d(".depot-resources-list").length||1<=d(".depot-resources-list__no-results").length){d("#edit-kategorie-id option").first().remove(),d("#edit-kategorie-id").select2({placeholder:t.depot.t_filterKategorienPlaceholder,maximumSelectionLength:1,multiple:!0,tags:!1,language:"de"}),d(".depot-resources-list__no-results-reset-filter").click(function(){d("#edit-kategorie-id").val(null).trigger("change")}),d("#edit-kategorie-id-wrapper").addClass("medium-8 column"),d("#views-exposed-form-resources-list-default").on("change",function(e){return console.log("chaaaange form!"),!1}),d("#edit-kategorie-id").on("selection:update",function(e){console.log("update")}),d("#edit-kategorie-id").on("select2:selecting",function(e){e.params.data}),Drupal.settings.views.ajaxViews.views_dom_id_startpage.view_display_id="page";var s=0;d(".depot-resources-list .resource-wrapper").each(function(e,t){9<=e&&d(t).addClass("hide"),s=e}),d("#depot-resources-list__btn-expand").click(function(){return d(this).addClass("hide"),d(".depot-resources-list .resource-wrapper.hide, #depot-resources-list__btn-show-more").removeClass("hide"),!1}),s<=9&&d("#depot-resources-list__btn-expand").trigger("click")}d('#edit-field-links-i input[type="text"]').keyup(function(){1<=d(this).val().length&&d("#edit-field-links-ii").removeClass("hide")}),d('#edit-field-links-ii input[type="text"]').keyup(function(){1<=d(this).val().length&&d("#edit-field-links-iii").removeClass("hide")}),d(".fieldset-toggle legend").click(function(){d(this).closest(".fieldset-toggle").toggleClass("toggled")}),d("body").hasClass("section-ressourcen")&&1<u.location.pathname.search("av")&&d("#verfuegbarkeitenModal").trigger("click");var i=d(".follow-box");if(0<i.length&&641<d(u).width()){for(var l=[],c=0;c<i.length;c++)l.push({element:i[c],offset:d(i[c]).offset()});d(u).scroll(function(e){for(var t=d(e.currentTarget).scrollTop(),o=0;o<l.length;o++){var a=i.height()+30;t>l[o].offset.top?(d(l[o].element).addClass("follow"),a<t?d(l[o].element).addClass("fade-out"):d(l[o].element).removeClass("fade-out")):d(l[o].element).removeClass("follow").removeClass("fade-out")}})}}}},{"./depot-maps":1}]},{},[1,2]);
>>>>>>> 87fefedda3330ba011fcac45dfd806f850d1afc1
